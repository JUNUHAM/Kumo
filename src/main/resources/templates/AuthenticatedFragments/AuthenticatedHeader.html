<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
  <div th:fragment="headerFragment">
    <header class="authenticated-header">
      <a th:href="@{/Recruiter/Main}" class="logo">
        <img
          th:src="@{/images/NonLogin/seekerLogo.png}"
          alt="KUMO"
          style="height: 40px;"
        />
      </a>
      <nav>
        <ul class="nav-menu">
          <li>
            <a th:href="@{/Recruiter/CompanyInfo}" th:text="#{header.company}"
              >회사 정보</a
            >
          </li>
          <li>
            <a th:href="@{/Recruiter/MyAccount}" th:text="#{header.account}"
              >내 계정</a
            >
          </li>
          <li>
            <a th:href="@{/logout}" th:text="#{header.logout}"
              >로그아웃</a
              >
            </form>
          </li>

          <li class="icon-btn lang-container" id="langBtn">
            <i class="fa-solid fa-globe"></i>
            <div class="lang-dropdown" id="langMenu">
              <a href="javascript:changeLang('ko')" class="lang-item">한국어</a>
              <a href="javascript:changeLang('ja')" class="lang-item">日本語</a>
            </div>
          </li>

          <li class="icon-btn" id="darkModeBtn">
            <i class="fa-regular fa-sun" id="darkModeIcon"></i>
          </li>
        </ul>
      </nav>
    </header>

    <script th:inline="javascript">
      /* <![CDATA[ */
      document.addEventListener("DOMContentLoaded", function() {
          const toggleBtn = document.getElementById('darkModeBtn');
          const icon = document.getElementById('darkModeIcon');
          const body = document.body;
          const currentTheme = localStorage.getItem('theme');

          // 초기 테마 설정
          if (currentTheme === 'dark') {
              body.classList.add('dark-mode');
              document.documentElement.classList.add('dark-mode');
              if(icon) icon.classList.replace('fa-sun', 'fa-moon');
          }

          if (toggleBtn) {
              toggleBtn.onclick = () => {
                  const isDark = body.classList.toggle('dark-mode');
                  document.documentElement.classList.toggle('dark-mode');
                  localStorage.setItem('theme', isDark ? 'dark' : 'light');
                  if(icon) {
                      if(isDark) icon.classList.replace('fa-sun', 'fa-moon');
                      else icon.classList.replace('fa-moon', 'fa-sun');
                  }
              };
          }

          // 언어 드롭다운
          const langBtn = document.getElementById('langBtn');
          const langMenu = document.getElementById('langMenu');
          if (langBtn && langMenu) {
              langBtn.onclick = (e) => { e.stopPropagation(); langMenu.classList.toggle('show'); };
              document.onclick = (e) => { if (!langBtn.contains(e.target)) langMenu.classList.remove('show'); };
          }
      });

      function changeLang(lang) {
          const url = new URL(window.location.href);
          url.searchParams.set('lang', lang);
          window.location.href = url.toString();
      }
      /* ]]> */
    </script>
  </div>
</html>
